<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <meta name="generator" content="Doxygen 1.8.4"/>
        <title>libfluid: Benchmarks</title>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-48360026-1', 'opennetworkingfoundation.github.io');
          ga('send', 'pageview');
        </script>
        <link href="tabs.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="extra.css" rel="stylesheet" type="text/css"/>
        <link rel="icon" type="image/png" href="libfluid_favicon.png">        
    </head>
<body>
    <div id="top">
        <div id="titlearea">
            <a href="http://opennetworkingfoundation.github.io/libfluid/">
            <div id="projectlogo"><img alt="Logo" src="libfluid_logo.png"></div>
            <div id="projecttitle">
                <div id="projectname">libfluid</div>
                <div id="projectbrief">The ONF OpenFlow driver</div>
            </div>
            </a>
            <div id="resources">GitHub:
                <a href="https://github.com/OpenNetworkingFoundation/libfluid">libfluid</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_base">libfluid_base</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_msg">libfluid_msg</a><br />
                <a href="https://groups.google.com/forum/#!forum/libfluid">Mailing list</a>
            </div>
        </div>
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Documentation</span></a></li>
      <li><a href="annotated.html"><span>API&#160;reference</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Benchmarks </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The tests below are not meant to be precise, but rather to show that <b>libfluid</b> performs slightly better or at least as well as existing OpenFlow controllers in extremely simple (and probably unfair) scenarios.</p>
<p>We benchmarked some existing controllers and two variations of <a href="md_examples_controller_README.html">example libfluid controllers</a>:</p>
<ul>
<li><b>msg</b>: uses <b>libfluid_base</b> as the backend, and <b>libfluid_msg</b> to build and parse messages</li>
<li><b>raw</b>: uses <b>libfluid_base</b> as the backend, and builds and parses messages directly in C.</li>
</ul>
<p>The benchmarks were performed on a desktop equipped with an Intel Core i7-2600 CPU (4 cores, 8 threads @ 3.4 GHz) with 8 GB of RAM (@1333 MHz) running Ubuntu 12.04.2 and its standard software stack. TCMalloc was used for better performance in C/C++, and recommended benchmarking guidelines were used when available. OpenJDK 7 64-bit provides the JDK/JRE for the Java controllers.</p>
<p><a href="http://www.openflowhub.org/display/floodlightcontroller/Cbench">cbench</a> is used to take the measurements.</p>
<h2>Test 1: Controller throughput</h2>
<p><b>Description</b>: This test shows a raw measurement of the throughput in different controllers and compares them to <b>libfluid</b>. These values show just part of the picture, since there are differences in the implementation of the learning switch in different controllers.</p>
<p><b>Switches</b>: 16</p>
<p><b>Controllers</b>: Beacon, NOX MT, Floodlight, raw, msg</p>
<p><b>Threads</b>: 8</p>
<p><b>Application</b>: learning switch</p>
<p><b>Command</b>: <code>cbench -c localhost -p 6653 -m 10000 -l 16 -s 16 -M 1000000 -t</code></p>
<p><b>Results (higher is better)</b>: </p>
<table class="doxtable">
<tr>
<th>Controller </th><th>flows/ms  </th></tr>
<tr>
<td>raw </td><td>7929.39 </td></tr>
<tr>
<td>Beacon </td><td>7682.54 </td></tr>
<tr>
<td>msg </td><td>5013.35 </td></tr>
<tr>
<td>Floodlight </td><td>2490.61 </td></tr>
<tr>
<td>NOX MT </td><td>2310.17 </td></tr>
</table>
<div class="image">
<img src="chart1.png" alt="chart1.png"/>
<div class="caption">
Controller throughput</div></div>
<p> <b>Comments</b>: the <b>msg</b> controller doesn't perform as well as the <b>raw</b> controller due to C++ object creation. The performance gap could be practically eliminated by using an object pool. Java doesn't seem to be affected by this problem as much, helping Beacon's great numbers.</p>
<h2>Test 2: Controller latency</h2>
<p><b>Description</b>: This test shows a comparison of the latencies introduced by different controllers running a learning switch application and compares them to <b>libfluid</b>. These values show just part of the picture, since there are differences in the implementation of the learning switch in different controllers.</p>
<p><b>Switches</b>: 16</p>
<p><b>Controllers</b>: Beacon, NOX MT, Floodlight, raw, msg</p>
<p><b>Threads</b>: 8</p>
<p><b>Application</b>: learning switch</p>
<p><b>Command</b>: <code>cbench -c localhost -p 6653 -m 10000 -l 16 -s 16 -M 1000000</code></p>
<p><b>Results (lower is better)</b>: </p>
<table class="doxtable">
<tr>
<th>Controller </th><th>ms  </th></tr>
<tr>
<td>Floodlight </td><td>0.005233 </td></tr>
<tr>
<td>msg </td><td>0.005213 </td></tr>
<tr>
<td>raw </td><td>0.005178 </td></tr>
<tr>
<td>Beacon </td><td>0.004978 </td></tr>
<tr>
<td>NOX MT </td><td>0.004576 </td></tr>
</table>
<div class="image">
<img src="chart2.png" alt="chart2.png"/>
<div class="caption">
Controller latency</div></div>
<p> <b>Comments</b>: we didn't optimize <b>libfluid</b> for latency at any time during development. It may be possible to improve these numbers.</p>
<blockquote class="doxtable">
<p>Tests 3 and 4 only measure <b>libfluid_base</b> (using the <b>raw</b> controller).</p>
<p></p>
</blockquote>
<h2>Test 3: Threading performance</h2>
<p><b>Description</b>: This test made to see how <b>libfluid</b> performance varies depending on the number of threads. In this test we use a different application, which simply replies to cbench's packet in events with dummy flow mods, so we can test how <b>libfluid_base</b> performs when tuning the number of threads used. We will call this application "cbench fast reply".</p>
<p><b>Switches</b>: 16</p>
<p><b>Controllers</b>: raw</p>
<p><b>Threads</b>: 1, 2, 4, 6, 8, 16</p>
<p><b>Application</b>: cbench fast reply application (see description)</p>
<p><b>Command</b>: <code>cbench -c localhost -p 6653 -m 10000 -l 16 -s 16 -M 1000000 -t</code></p>
<p><b>Results (higher is better)</b>: </p>
<table class="doxtable">
<tr>
<th>Threads </th><th>flows/ms  </th></tr>
<tr>
<td>1 </td><td>2781.02 </td></tr>
<tr>
<td>2 </td><td>5411.45 </td></tr>
<tr>
<td>4 </td><td>8777.26 </td></tr>
<tr>
<td>8 </td><td>8599.53 </td></tr>
<tr>
<td>16 </td><td>6937.99 </td></tr>
</table>
<div class="image">
<img src="chart3.png" alt="chart3.png"/>
<div class="caption">
Threading performance</div></div>
<p> <b>Comments</b>: due to the simple nature of the cbench fast reply application, its performance is better with 4 threads. The learning switch in all the other controllers runs faster with 8 threads.</p>
<h2>Test 4: Network size performance</h2>
<p><b>Description</b>: This test shows how <b>libfluid_base</b> performance scales when increasing the network size. The number of MACs per switch was reduced (from 1000k to 100k) to avoid thrashing.</p>
<p><b>Switches</b>: 1, 4, 16, 64, 256, 1000 (~2^2n, n = 0..5)</p>
<p><b>Controllers</b>: raw</p>
<p><b>Threads</b>: 8</p>
<p><b>Application</b>: learning switch</p>
<p><b>Command</b>: <code>cbench -c localhost -p 6653 -m 10000 -l 16 -s 16 -M 100000 -t</code></p>
<p><b>Results (higher is better)</b>: </p>
<table class="doxtable">
<tr>
<th>Switches </th><th>flows/ms  </th></tr>
<tr>
<td>1 </td><td>2327.88 </td></tr>
<tr>
<td>4 </td><td>7128.02 </td></tr>
<tr>
<td>16 </td><td>8013.98 </td></tr>
<tr>
<td>64 </td><td>7513.87 </td></tr>
<tr>
<td>256 </td><td>7334.20 </td></tr>
<tr>
<td>1000 </td><td>7386.28 </td></tr>
</table>
<div class="image">
<img src="chart4.png" alt="chart4.png"/>
<div class="caption">
Network size performance</div></div>
 <h2>Benchmarking parameters</h2>
<p><b>Beacon</b></p>
<p>Download the <a href="https://openflow.stanford.edu/static/beacon/releases/1.0.2/beacon-1.0.2-linux_x86_64.tar.gz">binary</a>. See the <a href="https://openflow.stanford.edu/display/Beacon/Benchmarking">instructions</a>.</p>
<p><b>NOX MT</b></p>
<p>Download from <a href="https://github.com/noxrepo/nox/archive/901365930e390f65af027e1bdbd5478824ed0715.zip">GitHub repo</a>.</p>
<p>Build with <code>../configure --enable-ndebug</code> and run with: </p>
<div class="fragment"><div class="line">export LD_PRELOAD=/usr/lib/libtcmalloc_minimal.so.0</div>
<div class="line">./nox_core -i ptcp:6653 -t 8 <span class="keywordflow">switch</span></div>
</div><!-- fragment --><p><b>Floodlight</b></p>
<p>Download the <a href="http://floodlight-download.projectfloodlight.org/files/floodlight-source-0.90.tar.gz">sources</a>.</p>
<p>See the <a href="http://www.openflowhub.org/display/floodlightcontroller/Benchmarking%2BConfiguration%2B%28New%29/">instructions</a>.</p>
<p>Put the following line in <code>/src/main/resources/floodlightdefault.properties</code>: </p>
<div class="fragment"><div class="line">net.floodlightcontroller.core.FloodlightProvider.workerthreads = 8</div>
</div><!-- fragment --><p> And then build and run: </p>
<div class="fragment"><div class="line">$ ant</div>
<div class="line">$ ./floodlight.sh</div>
</div><!-- fragment --><p><b>raw</b></p>
<p>Build with <code>-ltcmalloc -O3</code></p>
<p>Run with: <code>./raw_controller [app]</code></p>
<p><b>msg</b></p>
<p>Build with <code>-ltcmalloc -O3</code></p>
<p>Run with: <code>./msg_controller [app]</code></p>
<h2>Raw results</h2>
<p><b>Test 1</b></p>
<div class="fragment"><div class="line">Beacon: min/max/avg/stdev = 7647509.28/7707083.74/7682538.55/15944.03 responses/s</div>
<div class="line">NOX MT: min/max/avg/stdev = 2301158.41/2316124.24/2310168.71/4743.04 responses/s</div>
<div class="line">Floodlight: min/max/avg/stdev = 2480042.48/2497046.98/2490607.36/3884.80 responses/s</div>
<div class="line">msg:  min/max/avg/stdev = 4930998.74/5111914.47/5013347.86/42440.88 responses/s</div>
<div class="line">raw: min/max/avg/stdev = 7851036.82/7990869.67/7929393.73/46709.62 responses/s</div>
</div><!-- fragment --><p><b>Test 2</b></p>
<div class="fragment"><div class="line">Beacon: min/max/avg/stdev = 198540.41/204337.57/200897.40/1835.69 responses/s</div>
<div class="line">NOX MT: min/max/avg/stdev = 204663.01/228994.17/218518.12/8655.69 responses/s</div>
<div class="line">Floodlight: min/max/avg/stdev = 183894.52/198524.45/191110.76/3857.90 responses/s</div>
<div class="line">msg: min/max/avg/stdev = 188830.45/194961.50/191821.48/1630.58 responses/s</div>
<div class="line">raw: min/max/avg/stdev = 189850.55/194981.67/193142.60/1537.84 responses/s</div>
</div><!-- fragment --><p><b>Test 3</b></p>
<div class="fragment"><div class="line">1: min/max/avg/stdev = 2761671.41/2794672.62/2781022.80/9810.57 responses/s</div>
<div class="line">2: min/max/avg/stdev = 5328836.19/5517558.15/5411452.68/44456.04 responses/s</div>
<div class="line">4: min/max/avg/stdev = 8634876.72/8932773.29/8777258.26/89286.62 responses/s</div>
<div class="line">8: min/max/avg/stdev = 8228577.17/8784152.94/8599531.92/155841.58 responses/s</div>
<div class="line">16: min/max/avg/stdev = 4470191.61/8632553.93/6937985.79/1062298.97 responses/s</div>
</div><!-- fragment --><p><b>Test 4</b></p>
<div class="fragment"><div class="line">1: min/max/avg/stdev = 2312457.84/2393434.63/2327879.16/18281.92 responses/s</div>
<div class="line">4: min/max/avg/stdev = 6988507.83/7235151.68/7128015.58/55206.71 responses/s</div>
<div class="line">16: min/max/avg/stdev = 7905674.30/8100749.78/8013982.72/56862.44 responses/s</div>
<div class="line">64: min/max/avg/stdev = 7426037.07/7565181.74/7513872.24/35074.31 responses/s</div>
<div class="line">256: min/max/avg/stdev = 7136356.79/7460538.37/7334200.50/84778.20 responses/s</div>
<div class="line">1000: min/max/avg/stdev = 6932160.42/7461272.26/7386281.48/124029.92 responses/s</div>
</div><!-- fragment --> </div></div><!-- contents -->
<script type="text/javascript">
$("table.directory td.desc").remove();
</script>
