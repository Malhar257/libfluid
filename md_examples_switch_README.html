<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <meta name="generator" content="Doxygen 1.8.4"/>
        <title>libfluid: Example switch implementation</title>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-48360026-1', 'opennetworkingfoundation.github.io');
          ga('send', 'pageview');
        </script>
        <link href="tabs.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="extra.css" rel="stylesheet" type="text/css"/>
        <link rel="icon" type="image/png" href="libfluid_favicon.png">        
    </head>
<body>
    <div id="top">
        <div id="titlearea">
            <a href="http://opennetworkingfoundation.github.io/libfluid/">
            <div id="projectlogo"><img alt="Logo" src="libfluid_logo.png"></div>
            <div id="projecttitle">
                <div id="projectname">libfluid</div>
                <div id="projectbrief">The ONF OpenFlow driver</div>
            </div>
            </a>
            <div id="resources">GitHub:
                <a href="https://github.com/OpenNetworkingFoundation/libfluid">libfluid</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_base">libfluid_base</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_msg">libfluid_msg</a><br />
                <a href="https://groups.google.com/forum/#!forum/libfluid">Mailing list</a>
            </div>
        </div>
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Documentation</span></a></li>
      <li><a href="annotated.html"><span>API&#160;reference</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Example switch implementation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is an implementation of a very simple switch using <b>libfluid</b> .</p>
<p>It is built on top of <code>BaseOFClient</code> (which is analogous to <code><a class="el" href="classfluid__base_1_1BaseOFServer.html">fluid_base::BaseOFServer</a></code>). This code (which is in the <code>client</code> directory) was not included in <b>libfluid_base</b> because it was not considered mature enough, but it will be, eventually.</p>
<p>There's a <code>Makefile</code> in the <code>client</code> folder for compiling a client that just establishes and keeps a connection to an OpenFlow controller. You need to extend it to do anything useful.</p>
<h2>Building</h2>
<p>Along with the <b>libfluid</b> library requisites you will also need to install the pcap library with development headers.</p>
<p>On Ubuntu 12.04: </p>
<div class="fragment"><div class="line">$ sudo apt-<span class="keyword">get</span> install libcap-dev</div>
</div><!-- fragment --><p>After installing all dependencies, build the switch: </p>
<div class="fragment"><div class="line">$ make</div>
</div><!-- fragment --><h2>Running</h2>
<blockquote class="doxtable">
<p>This example uses the new, IANA-defined OpenFlow port: <b>6653</b> instead of the previous, non-standard default (6633).</p>
<p></p>
</blockquote>
<p>To run the switch you need to list the interfaces that will be used as OpenFlow ports. As the switch does not create interfaces, the names given to the command should be those of existent interfaces that can be put on promiscuous mode.</p>
<p>Start the switch with the interfaces for the ports. As interfaces will be set to promiscuous the command needs to be run as root: </p>
<div class="fragment"><div class="line">$ sudo ./<span class="keywordflow">switch</span> -i veth0 veth2 veth4 veth6</div>
</div><!-- fragment --><p>Optionally, it is possible to specify the switch datapath ID. If you don't, a random one will be generated for you. </p>
<div class="fragment"><div class="line">$ sudo ./<span class="keywordflow">switch</span> -i veth0 veth2 veth4 veth6 -d 0x0000000000000001</div>
</div><!-- fragment --><h2>Testing with OFTest</h2>
<p>The switch passes on a few basic OFTest cases, demonstrating basic functionality.</p>
<p>To start the environment, run the script run_switch.py. It will create the virtual interfaces expected by OFTest and run the switch with the created ports: </p>
<div class="fragment"><div class="line">$ sudo ./run_switch</div>
</div><!-- fragment --><p>Then go to the OFTest directory and run the basic tests: </p>
<div class="fragment"><div class="line">$ sudo ./oft basic.Echo</div>
<div class="line">$ sudo ./oft basic.PacketIn</div>
<div class="line">$ sudo ./oft basic.PacketOut</div>
<div class="line">$ sudo ./oft basic.FlowMod</div>
</div><!-- fragment --><h2>Testing with Mininet</h2>
<p>It is possible to use this switch in Mininet. Replace the Mininet file <code>mininet/bin/mn</code> and <code>mininet/mininet/node.py</code> with the ones in the <code>MininetFiles</code>.</p>
<p>Install Mininet again: </p>
<div class="fragment"><div class="line">$ sudo ./util/install.sh -n</div>
</div><!-- fragment --><p>Now, build and install the switch so that Mininet can find it: </p>
<div class="fragment"><div class="line">$ sudo make</div>
<div class="line">$ sudo make install</div>
</div><!-- fragment --><p>And start Mininet: </p>
<div class="fragment"><div class="line">$ sudo mn --topo single,3 --mac --<span class="keywordflow">switch</span> fluid --controller=remote,ip=127.0.0.1,port=6653</div>
</div><!-- fragment --><p>The switch functionality is enough to run a simple learning switch application, like the one present in the <code>controller</code> example or the POX l2_forwarding application. </p>
</div></div><!-- contents -->
<script type="text/javascript">
$("table.directory td.desc").remove();
</script>
