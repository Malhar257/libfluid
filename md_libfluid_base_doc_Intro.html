<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <meta name="generator" content="Doxygen 1.8.4"/>
        <title>libfluid: A quick intro to libfluid_base</title>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-48360026-1', 'opennetworkingfoundation.github.io');
          ga('send', 'pageview');
        </script>
        <link href="tabs.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="extra.css" rel="stylesheet" type="text/css"/>
        <link rel="icon" type="image/png" href="libfluid_favicon.png">        
    </head>
<body>
    <div id="top">
        <div id="titlearea">
            <a href="http://opennetworkingfoundation.github.io/libfluid/">
            <div id="projectlogo"><img alt="Logo" src="libfluid_logo.png"></div>
            <div id="projecttitle">
                <div id="projectname">libfluid</div>
                <div id="projectbrief">The ONF OpenFlow driver</div>
            </div>
            </a>
            <div id="resources">GitHub:
                <a href="https://github.com/OpenNetworkingFoundation/libfluid">libfluid</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_base">libfluid_base</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_msg">libfluid_msg</a><br />
                <a href="https://groups.google.com/forum/#!forum/libfluid">Mailing list</a>
            </div>
        </div>
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Documentation</span></a></li>
      <li><a href="annotated.html"><span>API&#160;reference</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">A quick intro to libfluid_base </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>libfluid_base</b> (namespace <a class="el" href="namespacefluid__base.html">fluid_base</a>) defines a client-server architecture, in which a controller is a server and a switch is a client. It provides a base class upon which you can build your controller (by inheritance): <a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a>.</p>
<h2>Build and install</h2>
<p><b>libfluid_base</b> has been tested on Ubuntu 12.04 and Fedora 19. It should run on other flavors of Linux. MacOS, Windows and BSD variations are currently not supported, but they should run with some simple changes (we plan to support them oficially in the future).</p>
<p><b>libfluid_base</b> requires <a href="http://libevent.org/">libevent</a> 2.0 and (optionally) OpenSSL 1.0.</p>
<h3>Ubuntu 12.04</h3>
<p>Install the dependencies: </p>
<div class="fragment"><div class="line">$ sudo apt-<span class="keyword">get</span> install autoconf libtool build-essential pkg-config</div>
<div class="line">$ sudo apt-<span class="keyword">get</span> install libevent-dev libssl-dev</div>
</div><!-- fragment --><p>Build: </p>
<div class="fragment"><div class="line">$ ./configure</div>
<div class="line">$ make</div>
<div class="line">$ sudo make install</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>If you want to compile without TLS support, pass the <code>--disable-tls</code> flag to <code>configure</code>. This will remove the dependency on OpenSSL.</p>
<p></p>
</blockquote>
<p>Configure your system to find libraries in <code>/usr/local/lib</code>: </p>
<div class="fragment"><div class="line">$ sudo sh -c <span class="stringliteral">&quot;echo /usr/local/lib &gt; /etc/ld.so.conf.d/libfluid.conf&quot;</span></div>
<div class="line">$ sudo ldconfig</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>You can skip this last step by running <code>./configure --prefix=/usr</code> in the build.</p>
<p></p>
</blockquote>
<h3>Fedora 19</h3>
<p>Install the dependencies: </p>
<div class="fragment"><div class="line">$ sudo yum install autoconf automake gcc-g++ libtool</div>
<div class="line">$ sudo yum install libevent-devel openssl-devel</div>
</div><!-- fragment --><p>Build: </p>
<div class="fragment"><div class="line">$ ./configure</div>
<div class="line">$ make</div>
<div class="line">$ sudo make install</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>If you want to compile without TLS support, pass the <code>--disable-tls</code> flag to <code>configure</code>. This will remove the dependency on OpenSSL.</p>
<p></p>
</blockquote>
<p>Configure your system to find libraries in <code>/usr/local/lib</code>: </p>
<div class="fragment"><div class="line">$ sudo sh -c <span class="stringliteral">&quot;echo /usr/local/lib &gt; /etc/ld.so.conf.d/libfluid.conf&quot;</span></div>
<div class="line">$ sudo ldconfig</div>
</div><!-- fragment --><h2>Usage</h2>
<p>To use <b>libfluid_base</b>, you will need to include: </p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;fluid/OFServer.hh&gt;</span></div>
</div><!-- fragment --><p>Link with your code with <code>-lfluid_base</code>.</p>
<h2>Coding with libfluid_base</h2>
<blockquote class="doxtable">
<p>For more examples on how to use the library, see the examples included in the <b>libfluid</b> bundle.</p>
<p></p>
</blockquote>
<p><a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a> takes a port number, the number of workers to use, optional TLS support and few configuration parameters (<a class="el" href="classfluid__base_1_1OFServerSettings.html">fluid_base::OFServerSettings</a>) that define how it should deal with some basic OpenFlow features. It also expects you to implement two callback method for dealing with connection events and messages.</p>
<p>The number of workers will define how many of them will be created when the server starts. Every worker will run in its own thread (which are automatically managed for you), and each will handle a certain number of connections, distributed in a round-robin fashion. Typically, these connections will be presented to you as <a class="el" href="classfluid__base_1_1OFConnection.html">fluid_base::OFConnection</a> objects in the callbacks.</p>
<p>Finally, these are the callbacks you should implement:</p>
<ul>
<li><a class="el" href="classfluid__base_1_1OFServer.html#aadcb813c61a541f41450fea51f97690e">fluid_base::OFServer::message_callback</a>: called when a new message arrives</li>
<li><a class="el" href="classfluid__base_1_1OFServer.html#ab79f4e7cf6a50e3d2e64b9ca8f0cf6c4">fluid_base::OFServer::connection_callback</a>: called when a connection event happens (e.g.: establishment or disconnection).</li>
</ul>
<p>These methods can be called from any of the threads that handle connections, so they must be thread-safe and return as quickly as possible (so the other connections don't starve waiting for a callback to complete). You can quickly build up a representation of the events and put them in an asynchronous queue for use by other parts of your controller or application, for instance. The examples provided with <b>libfluid</b> don't do this for the sake of simplicity.</p>
<p>The image below illustrates how your implementation can use <b>libfluid_base</b>.</p>
<div class="image">
<img src="libfluid.png" alt="libfluid.png"/>
<div class="caption">
Using libfluid</div></div>
<p> This image is a rough representation of the architecture and workflow; if you see something slightly different or better defined in code, the code is right :)</p>
<p>For more advanced use cases, take a look at <a class="el" href="classfluid__base_1_1BaseOFServer.html">fluid_base::BaseOFServer</a> and <a class="el" href="classfluid__base_1_1BaseOFConnection.html">fluid_base::BaseOFConnection</a>. They provide the basic functionalities upon which <a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a> and <a class="el" href="classfluid__base_1_1OFConnection.html">fluid_base::OFConnection</a> are built. However, you shouldn't need to deal with them most of the time. </p>
</div></div><!-- contents -->
<script type="text/javascript">
$("table.directory td.desc").remove();
</script>
