<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, user-scalable=no">
        <meta name="generator" content="Doxygen 1.8.4"/>
        <title>libfluid: Secure connections with libfluid</title>
        <script>
          (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
          (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
          m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
          })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
          ga('create', 'UA-48360026-1', 'opennetworkingfoundation.github.io');
          ga('send', 'pageview');
        </script>
        <link href="tabs.css" rel="stylesheet" type="text/css"/>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript" src="dynsections.js"></script>
        <link href="doxygen.css" rel="stylesheet" type="text/css" />
        <link href="extra.css" rel="stylesheet" type="text/css"/>
        <link rel="icon" type="image/png" href="libfluid_favicon.png">        
    </head>
<body>
    <div id="top">
        <div id="titlearea">
            <a href="http://opennetworkingfoundation.github.io/libfluid/">
            <div id="projectlogo"><img alt="Logo" src="libfluid_logo.png"></div>
            <div id="projecttitle">
                <div id="projectname">libfluid</div>
                <div id="projectbrief">The ONF OpenFlow driver</div>
            </div>
            </a>
            <div id="resources">GitHub:
                <a href="https://github.com/OpenNetworkingFoundation/libfluid">libfluid</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_base">libfluid_base</a> | 
                <a href="https://github.com/OpenNetworkingFoundation/libfluid_msg">libfluid_msg</a><br />
                <a href="https://groups.google.com/forum/#!forum/libfluid">Mailing list</a>
            </div>
        </div>
<!-- Generated by Doxygen 1.8.4 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Home</span></a></li>
      <li class="current"><a href="pages.html"><span>Documentation</span></a></li>
      <li><a href="annotated.html"><span>API&#160;reference</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Secure connections with libfluid </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>It is possible to use TLS on top of <b>libfluid</b>. The implementation was tested with Open vSwitch 1.4.0 (default version for Ubuntu 1.4.0). The <code>controller/secure</code> example shows how to setup TLS in <b>libfluid</b>.</p>
<p><b>libfluid</b> must be compiled with TLS support for this feature to work. This is the default; unless you have explicitly passed the <code>--disable-tls</code> flag to <code>configure</code>, you don't need to worry.</p>
<p>To get started, follow the <a href="http://git.openvswitch.org/cgi-bin/gitweb.cgi?p=openvswitch;a=blob_plain;f=INSTALL.SSL;hb=HEAD">OVS tutorial for TLS</a>.</p>
<p>You will need three files created in the tutorial above:</p>
<ul>
<li><code>ctl-cert.pem</code>: this is the controller certificate, signed by the controllerca. This will be sent to the switches so that they can verify the controller can be trusted and establish communication.</li>
<li><code>ctl-privkey.pem</code>: this is the controller private key, used to encrypt data.</li>
<li><code>switchca/cacert.pem</code>: this is the file created by Open vSwitch for the CA signing switch certificates. We will need it to verify that the switches connecting to us are trusted. On Ubuntu 12.04, they will tipically be at <code>/usr/share/openvswitch/pki/switchca/cacert.pem</code>.</li>
</ul>
<blockquote class="doxtable">
<p>Don't use the self-signed certificates scheme. <b>libfluid</b> needs a full PKI.</p>
<p></p>
</blockquote>
<blockquote class="doxtable">
<p>There's a script in this example (<code>controller/secure/switch.sh</code>) to start OVS using the right parameters. You just need to create the PKI and the keys.</p>
<p></p>
</blockquote>
<p>Once you have created these three files, starting your secure <a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a> instance is really easy: </p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span>fluid_base;</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacefluid__base.html#a423d25480251ffdbc9038d2dedde44c8">libfluid_tls_init</a>(<span class="stringliteral">&quot;/path/to/ctl-cert.pem&quot;</span>,</div>
<div class="line">                  <span class="stringliteral">&quot;/path/to/ctl-privkey.pem&quot;</span>,</div>
<div class="line">                  <span class="stringliteral">&quot;/path/to/ovs/pki/switchca/cacert.pem&quot;</span>);</div>
<div class="line"></div>
<div class="line"><a class="code" href="classfluid__base_1_1OFServer.html">OFServer</a> srv(<span class="stringliteral">&quot;localhost&quot;</span>, 6653, 2, <span class="keyword">true</span>);</div>
<div class="line"></div>
<div class="line">[...]</div>
<div class="line"></div>
<div class="line"><a class="code" href="namespacefluid__base.html#a1be247395c6ec839a43235860a48b387">libfluid_tls_clear</a>();</div>
</div><!-- fragment --><p>The only thing that changes is the fourth argument to <a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a>: <code>secure</code>.</p>
<p>This parameter will make all connection on this <a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a> instance be secured with SSL, as long as you call <a class="el" href="namespacefluid__base.html#a423d25480251ffdbc9038d2dedde44c8">fluid_base::libfluid_tls_init</a> first.</p>
<p>The parameters to <a class="el" href="namespacefluid__base.html#a423d25480251ffdbc9038d2dedde44c8">fluid_base::libfluid_tls_init</a> are valid for <b>all</b> <a class="el" href="classfluid__base_1_1OFServer.html">fluid_base::OFServer</a> instances in the program that use the <code>secure</code> option.</p>
<p>Calling <a class="el" href="namespacefluid__base.html#a1be247395c6ec839a43235860a48b387">fluid_base::libfluid_tls_clear</a> at the end of the execution frees some data allocated internally by the SSL library.</p>
<p>If you see this error: </p>
<div class="fragment"><div class="line">Error loading <span class="keyword">private</span> key.</div>
</div><!-- fragment --><p>You probably need to run the controller with the right privileges for reading the private key.</p>
<p><b>libfluid</b> uses OpenSSL for providing TLS. </p>
</div></div><!-- contents -->
<script type="text/javascript">
$("table.directory td.desc").remove();
</script>
